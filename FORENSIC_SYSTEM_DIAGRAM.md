# ğŸ—ï¸ SYSTEM ARCHITECTURE DIAGRAM
**Book Explorer Enterprise System - Forensic Audit**

## ğŸ¨ HIGH-LEVEL ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BOOK EXPLORER SYSTEM                            â”‚
â”‚                      (Enterprise ERP Platform)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND LAYER     â”‚
â”‚  (React 18 + TS 5)   â”‚
â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Public Routes  â”‚  â”‚
â”‚  â”‚ - /auth        â”‚  â”‚
â”‚  â”‚ - /reset-pwd   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Protected Routesâ”‚  â”‚
â”‚  â”‚ - Dashboard    â”‚  â”‚
â”‚  â”‚ - Financial    â”‚  â”‚
â”‚  â”‚ - HRMS         â”‚  â”‚
â”‚  â”‚ - Performance  â”‚  â”‚
â”‚  â”‚ - Settings     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚
â”‚  State Management:   â”‚
â”‚  â”œâ”€ React Query     â”‚
â”‚  â”œâ”€ Context API     â”‚
â”‚  â””â”€ Local Storage   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ HTTPS
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SUPABASE BACKEND (BaaS)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ SUPABASE AUTHâ”‚  â”‚ POSTGREST APIâ”‚  â”‚  REALTIME    â”‚                 â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚                 â”‚
â”‚  â”‚ - Email/Pass â”‚  â”‚ - REST API   â”‚  â”‚ - WebSocket  â”‚                 â”‚
â”‚  â”‚ - OAuth      â”‚  â”‚ - Auto CRUD  â”‚  â”‚ - Live Query â”‚                 â”‚
â”‚  â”‚ - Sessions   â”‚  â”‚ - RPC Calls  â”‚  â”‚              â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                  â”‚                                            â”‚
â”‚         â–¼                  â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              POSTGRESQL DATABASE (Core Data)                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  FINANCIAL ENGINE (11 tables)                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ chart_of_accounts                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€ fiscal_periods                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ journal_entries / journal_entry_lines                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ invoices / invoice_items                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€ bills / bill_items                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ vendors                                                      â”‚   â”‚
â”‚  â”‚  â”œâ”€ payment_allocations                                         â”‚   â”‚
â”‚  â”‚  â””â”€ credit_notes                                                â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  TREASURY & BANKING (3 tables)                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ bank_accounts                                               â”‚   â”‚
â”‚  â”‚  â”œâ”€ bank_transactions                                           â”‚   â”‚
â”‚  â”‚  â””â”€ scheduled_payments                                          â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  HR & PAYROLL (9 tables)                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ profiles (employee master)                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ attendance_records                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ leave_balances / leave_requests                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ payroll_records                                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ goals / memos                                               â”‚   â”‚
â”‚  â”‚  â”œâ”€ holidays                                                    â”‚   â”‚
â”‚  â”‚  â””â”€ working_week_policy                                         â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  BUDGET & COST (4 tables)                                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ cost_centers                                                â”‚   â”‚
â”‚  â”‚  â”œâ”€ account_cost_center_mappings                                â”‚   â”‚
â”‚  â”‚  â”œâ”€ budgets                                                     â”‚   â”‚
â”‚  â”‚  â””â”€ budget_lines                                                â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  SECURITY & SYSTEM (10+ tables)                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ roles / permissions / role_permissions                      â”‚   â”‚
â”‚  â”‚  â”œâ”€ user_roles                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ audit_logs                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ notifications                                               â”‚   â”‚
â”‚  â”‚  â”œâ”€ bulk_upload_sessions / bulk_upload_rows                     â”‚   â”‚
â”‚  â”‚  â””â”€ bulk_upload_history                                         â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  FEATURES:                                                      â”‚   â”‚
â”‚  â”‚  âœ… 90+ indexes (performance)                                   â”‚   â”‚
â”‚  â”‚  âœ… 40+ triggers (audit, validation, timestamps)                â”‚   â”‚
â”‚  â”‚  âœ… 50+ RPC functions (business logic)                          â”‚   â”‚
â”‚  â”‚  âœ… 200+ RLS policies (row-level security)                      â”‚   â”‚
â”‚  â”‚  âœ… Soft delete (8 tables)                                      â”‚   â”‚
â”‚  â”‚  âœ… Audit trail (financial tables)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Deployed to
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        LOVABLE CLOUD CDN                                â”‚
â”‚                    (Static Build Deployment)                            â”‚
â”‚                                                                         â”‚
â”‚  âœ… Auto-deploy from GitHub                                             â”‚
â”‚  âœ… Global CDN distribution                                             â”‚
â”‚  âœ… HTTPS enabled                                                       â”‚
â”‚  âœ… Environment variables                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ DATA FLOW DIAGRAMS

### Invoice Creation Flow

```
USER                FRONTEND              SUPABASE              DATABASE
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚ Fill Invoice Form   â”‚                     â”‚                     â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                     â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚ Zod Validation      â”‚                     â”‚
 â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>        â”‚                     â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚ RPC: create_invoice_â”‚                     â”‚
 â”‚                     â”‚   with_items()      â”‚                     â”‚
 â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚                     â”‚ BEGIN TRANSACTION   â”‚
 â”‚                     â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚                     â”‚ INSERT invoices     â”‚
 â”‚                     â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                     â”‚                     â”‚ RETURNING id        â”‚
 â”‚                     â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚                     â”‚ INSERT invoice_itemsâ”‚
 â”‚                     â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚                     â”‚ COMMIT              â”‚
 â”‚                     â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚ Success {invoice_id}â”‚                     â”‚
 â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚ Toast: "Created!"   â”‚                     â”‚                     â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                     â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚ React Query:        â”‚                     â”‚
 â”‚                     â”‚ Invalidate cache    â”‚                     â”‚
 â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>        â”‚                     â”‚
```

### Payroll Processing Flow (âš ï¸ NOT ATOMIC)

```
USER                FRONTEND              SUPABASE              DATABASE
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚ Create Payroll      â”‚                     â”‚                     â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                     â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚ INSERT payroll_     â”‚                     â”‚
 â”‚                     â”‚   records           â”‚                     â”‚
 â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚                     â”‚ Success             â”‚                     â”‚
 â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚ âš ï¸ MANUAL STEP 1    â”‚                     â”‚                     â”‚
 â”‚ Create Journal      â”‚                     â”‚                     â”‚
 â”‚ Entry               â”‚                     â”‚                     â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚ âš ï¸ MANUAL STEP 2    â”‚                     â”‚                     â”‚
 â”‚ Create Bank         â”‚                     â”‚                     â”‚
 â”‚ Transaction         â”‚                     â”‚                     â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                     â”‚                     â”‚                     â”‚
 â”‚  âŒ RISK: Partial failure can leave accounting inconsistent     â”‚
```

---

## ğŸ” SECURITY ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SECURITY LAYERS                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LAYER 1: AUTHENTICATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Auth                        â”‚
â”‚ â”œâ”€ Email/Password (with verification)â”‚
â”‚ â”œâ”€ OAuth Callback Support            â”‚
â”‚ â”œâ”€ Session Management (JWT)          â”‚
â”‚ â””â”€ Password Reset Flow               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
LAYER 2: AUTHORIZATION (Frontend)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React Context + Hooks                â”‚
â”‚ â”œâ”€ useIsAdminOrHR()  âœ… IMPLEMENTED  â”‚
â”‚ â”œâ”€ useIsManager()    âœ… IMPLEMENTED  â”‚
â”‚ â”œâ”€ useIsFinance()    âŒ MISSING      â”‚
â”‚ â””â”€ ProtectedRoute    âœ… IMPLEMENTED  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
LAYER 3: ROW LEVEL SECURITY (Database)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL RLS Policies (200+)       â”‚
â”‚ â”œâ”€ User Isolation (user_id check)    â”‚
â”‚ â”œâ”€ Admin Bypass (is_admin_or_hr())   â”‚
â”‚ â”œâ”€ Manager Team Access (FK: manager) â”‚
â”‚ â””â”€ âš ï¸ No Org-level (multi-tenant gap)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
LAYER 4: DATA ENCRYPTION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Default Encryption          â”‚
â”‚ â”œâ”€ Data at Rest (AES-256)            â”‚
â”‚ â”œâ”€ Data in Transit (TLS 1.3)         â”‚
â”‚ â””â”€ Encrypted Backups                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ STATE MANAGEMENT FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REACT CONTEXT HIERARCHY                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

App.tsx
  â”‚
  â”œâ”€> QueryClientProvider (TanStack Query)
  â”‚     â”‚
  â”‚     â””â”€> Data Fetching & Caching Layer
  â”‚           â”œâ”€ useInvoices()
  â”‚           â”œâ”€ usePayroll()
  â”‚           â”œâ”€ useEmployees()
  â”‚           â””â”€ 16 more custom hooks
  â”‚
  â”œâ”€> ThemeProvider
  â”‚     â”‚
  â”‚     â””â”€> Dark/Light Mode (localStorage)
  â”‚
  â”œâ”€> AuthProvider
  â”‚     â”‚
  â”‚     â”œâ”€> User Session State
  â”‚     â”œâ”€> Login/Logout Logic
  â”‚     â””â”€> Password Reset
  â”‚
  â”œâ”€> AppModeProvider
  â”‚     â”‚
  â”‚     â””â”€> App Mode Switching (localStorage)
  â”‚
  â””â”€> DevModeProvider
        â”‚
        â”œâ”€> Dev Toolbar State
        â”œâ”€> Role Switching (dev only)
        â””â”€> Permission Debugging
```

---

## ğŸ“Š TECHNOLOGY STACK DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TECHNOLOGY STACK                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FRONTEND
â”œâ”€ React 18.3.1             (UI Framework)
â”œâ”€ TypeScript 5.8.3         (Language)
â”œâ”€ Vite 5.4.19              (Build Tool)
â”œâ”€ Tailwind CSS 3.4.17      (Styling)
â”œâ”€ shadcn/ui                (Component Library)
â”‚   â””â”€ Radix UI primitives  (Accessible components)
â”œâ”€ TanStack Query 5.83.0    (Data Fetching)
â”œâ”€ React Hook Form 7.61.1   (Forms)
â”œâ”€ Zod 3.25.76              (Validation)
â”œâ”€ React Router 6.30.1      (Routing)
â”œâ”€ Recharts 2.15.4          (Charts)
â”œâ”€ xlsx 0.18.5              (Excel Import)
â””â”€ Framer Motion 12.33.0    (Animations)

BACKEND (BaaS)
â”œâ”€ Supabase
â”‚   â”œâ”€ PostgreSQL 15+       (Database)
â”‚   â”œâ”€ PostgREST            (Auto API)
â”‚   â”œâ”€ GoTrue               (Auth)
â”‚   â””â”€ Realtime             (WebSocket)

DEPLOYMENT
â”œâ”€ Lovable Cloud            (Hosting)
â”œâ”€ GitHub                   (Version Control)
â””â”€ Auto-deploy Pipeline     (CI/CD)

DEVELOPMENT
â”œâ”€ ESLint 9.32.0            (Linting)
â”œâ”€ Vitest 3.2.4             (Testing)
â”œâ”€ lovable-tagger 1.1.13    (AI Development)
â””â”€ Concurrently 8.2.2       (Multi-process)
```

---

END OF SYSTEM DIAGRAM
